mod application;

class Start {

    var x;

    static fn foo(var[] message) {
        try {
        __asm(
            "odessy/x64/print.asm"
        );
        }catch(RuntimeErr re) {
            re.getStackTrace();
        }
    }

    Start() {
        __asm("odessy/x64/constructor_call.asm");
    }

    fn mult(var x) : var {
        return (10*x)/2;
        __asm(
            "movr %adx,%fp"
            "smov %ebx+1"
            "imul %ebx,10"
            "idiv %bmr,2"
            "smovr %bmr-0x5"
            "ret"
        );
    }

    static fn __init(var[] args) {
        var[] message = "";
        Start start;
        __asm("odessy/x64/function_call.asm");

        __asm(
            "movl <start>"            // start = new Start();
            "inc %sp"
            "iframe"
            "pushref"
            "movn 0"
            "movi #0,%adx "
            "mov %adx,#5"
            "movx %ebx,%adx"
            "pushr %ebx"
            "call <mult>"              // mult(start.x);
            "movr %adx,%sp"
            "smov %ebx+0"
            "put %ebx"
        );

        __asm("ret");
    }
}